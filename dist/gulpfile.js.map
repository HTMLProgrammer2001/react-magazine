{"version":3,"file":"gulpfile.js","sourceRoot":"","sources":["../gulpfile.js"],"names":[],"mappings":";;;;;;;;;;;;AACA,IAAM,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC7B,IAAM,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACtC,IAAM,QAAQ,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC3C,IAAM,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACtC,IAAM,YAAY,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAClD,IAAM,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACxC,IAAM,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAClC,IAAM,QAAQ,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC1C,IAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACpC,IAAM,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACtC,IAAM,SAAS,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;AAC7C,IAAM,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAEtC,IAAM,WAAW,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC,MAAM,EAAE,CAAC;AAGrD,IAAM,aAAa,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAChD,IAAM,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAC;AACrD,IAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AAGnC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAGrC,IAAM,QAAQ,GAAG,eAAe,EAC/B,SAAS,GAAG,QAAQ,CAAC;AAGtB,SAAS,IAAI;IAGZ,OAAO,IAAI,CAAC,GAAG,CAAI,QAAQ,+BAA4B,EAAE;QACxD,UAAU,EAAE,IAAI;KAChB,CAAC;SAEA,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;SACtB,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;SAGvC,IAAI,CAAC,YAAY,EAAE,CAAC;SACpB,IAAI,CAAC,QAAQ,EAAE,CAAC;SAGhB,IAAI,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,CAAC;QACvB,QAAQ,EAAE,IAAI,CAAC,QAAQ;QACvB,OAAO,EAAE,IAAI;QACb,OAAO,EAAE,MAAM;KACf,CAAC,EAJqB,CAIrB,CAAC,CAAC;SAGH,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;SAC1B,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;SACvB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAI,SAAS,SAAM,CAAC,CAAC;SAGnC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;AAC9B,CAAC;AAED,SAAS,EAAE,CAAC,IAAI;IAMf,OAAO,SAAS,UAAU;QACzB,OAAO,IAAI,CAAC,GAAG,CAAI,QAAQ,iBAAc,EAAE;YAC1C,UAAU,EAAE,IAAI;SAChB,CAAC;aAEA,IAAI,CAAC,MAAM,EAAE,CAAC;aACd,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;aAClD,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC;aAG7B,IAAI,CAAC,aAAa,uBACf,aAAa,KAChB,IAAI,MAAA,EACJ,OAAO,EAAE,YAAY,KACnB,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,EAAC,UAAU,GAAG;YACpC,OAAO,CAAC,KAAK,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;YACpC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClB,CAAC,CAAC;aAGD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAC,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAC;aACtC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,EAAE,GAAG,EAAE,EAAE;YAMxC,IAAM,WAAW,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE7C,IAAI,CAAC,WAAW,EAAE;gBACjB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAChB;YAED,EAAE,EAAE,CAAC;QACN,CAAC,CAAC,CAAC;aAEF,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;aACzB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;aAQ1B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAI,SAAS,QAAK,CAAC,CAAC;aAElC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;IAC9B,CAAC,CAAC;AACH,CAAC;AAED,SAAS,KAAK;IACb,OAAO,IAAI,CAAC,GAAG,CAAI,QAAQ,kBAAe,CAAC;SAEzC,IAAI,CAAC,QAAQ,EAAE,CAAC;SAChB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAI,SAAS,YAAS,CAAC,CAAC;SACtC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;AAC9B,CAAC;AAED,SAAS,GAAG;IACX,OAAO,IAAI,CAAC,GAAG,CAAI,QAAQ,uBAAoB,EAAE;QAChD,UAAU,EAAE,IAAI;KAChB,CAAC;SACA,IAAI,CAAC,WAAW,CAAC,EAAC,MAAM,EAAE,IAAI,EAAC,CAAC,CAAC;SACjC,IAAI,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,CAAC;QACvB,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAChE,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;QACzD,OAAO,EAAE,OAAO;KAChB,CAAC,EAJqB,CAIrB,CAAC,CAAC;SACH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAG,SAAW,CAAC,CAAC;SAC/B,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;AAC9B,CAAC;AAED,SAAS,KAAK;IACb,WAAW,CAAC,IAAI,CAAC;QAChB,KAAK,EAAE,gBAAgB;KACvB,CAAC,CAAC;IAEH,IAAI,CAAC,KAAK,CAAI,QAAQ,uBAAoB,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;IAClF,IAAI,CAAC,KAAK,CAAI,QAAQ,oBAAiB,EAAE,IAAI,CAAC,CAAC;IAC/C,IAAI,CAAC,KAAK,CAAI,QAAQ,iBAAc,EAAE,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;IACzD,IAAI,CAAC,KAAK,CAAI,QAAQ,gBAAa,EAAE,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;AACzD,CAAC;AAED,SAAS,KAAK;IACb,OAAO,IAAI,CAAC,QAAQ,CACnB,GAAG,EAAE,IAAI,EAAE,EAAE,CAAC,YAAY,CAAC,EAAE,KAAK,CAClC,CAAC;AACH,CAAC;AAED,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AACxB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;AACvB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;AAClC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;AAC5B,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC","sourcesContent":["//Gulp modules\r\nconst gulp = require('gulp');\r\nconst concat = require('gulp-concat');\r\nconst cleanCSS = require('gulp-clean-css');\r\nconst uglify = require('gulp-uglify');\r\nconst autoprefixer = require('gulp-autoprefixer');\r\nconst pugCompiler = require('gulp-pug');\r\nconst sass = require('gulp-sass');\r\nconst imagemin = require('gulp-imagemin');\r\nconst through = require('through2');\r\nconst rename = require('gulp-rename');\r\nconst sourceMap = require('gulp-sourcemaps');\r\nconst eslint = require('gulp-eslint');\r\n\r\nconst browserSync = require('browser-sync').create();\r\n\r\n//Webpack configuration\r\nconst webpackStream = require('webpack-stream');\r\nconst webpackConfig = require('./webpack.config.js');\r\nconst webpack = require('webpack');\r\n\r\n//Set ruby compiler to use\r\nsass.compiler = require('node-sass');\r\n\r\n//Paths\r\nconst SRC_PATH = 'resources/app',\r\n\tDIST_PATH = 'public';\r\n\r\n\r\nfunction scss(){\r\n\t//SCSS styles\r\n\r\n\treturn gulp.src(`${SRC_PATH}/scss/pages/**/*.page.scss`, {\r\n\t\tallowEmpty: true\r\n\t})\r\n\t\t//Create source map\r\n\t\t.pipe(sourceMap.init())\r\n\t\t.pipe(sass().on('error', sass.logError))\r\n\r\n\t\t//Postcss\r\n\t\t.pipe(autoprefixer())\r\n\t\t.pipe(cleanCSS())\r\n\r\n\t\t//Rename files\r\n\t\t.pipe(rename((path) => ({\r\n\t\t\tbasename: path.basename,\r\n\t\t\tdirname: './',\r\n\t\t\textname: '.css'\r\n\t\t})))\r\n\r\n\t\t//Save\r\n\t\t.pipe(concat('bundle.css'))\r\n\t\t.pipe(sourceMap.write())\r\n\t\t.pipe(gulp.dest(`${DIST_PATH}/css`))\r\n\r\n\t\t//Reload\r\n\t\t.pipe(browserSync.stream());\r\n}\r\n\r\nfunction js(mode){\r\n\t/*\r\n\t * Javascript files\r\n\t * mode = production | development\r\n\t */\r\n\r\n\treturn function javascript(){\r\n\t\treturn gulp.src(`${SRC_PATH}/js/main.tsx`, {\r\n\t\t\tallowEmpty: true\r\n\t\t})\r\n\t\t\t//Linters\r\n\t\t\t.pipe(eslint())\r\n\t\t\t.pipe(eslint.formatEach('compact', process.stderr))\r\n\t\t\t.pipe(eslint.failAfterError())\r\n\r\n\t\t\t//Send webpack\r\n\t\t\t.pipe(webpackStream({\r\n\t\t\t\t...webpackConfig,\r\n\t\t\t\tmode,\r\n\t\t\t\tdevtool: 'source-map'\r\n\t\t\t}, webpack)).on('error',function (err) {\r\n\t\t\t\tconsole.error('WEBPACK ERROR', err);\r\n\t\t\t\tthis.emit('end'); // Don't stop the rest of the task\r\n\t\t\t})\r\n\r\n\t\t\t//Create source maps\r\n\t\t\t.pipe(sourceMap.init({loadMaps: true}))\r\n\t\t\t.pipe(through.obj(function (file, enc, cb) {\r\n\t\t\t\t/*\r\n\t\t\t\t * Dont pipe through any source map files as\r\n\t\t\t\t * it will be handled by gulp-sourcemaps\r\n\t\t\t\t */\r\n\r\n\t\t\t\tconst isSourceMap = /\\.map$/.test(file.path);\r\n\r\n\t\t\t\tif (!isSourceMap) {\r\n\t\t\t\t\tthis.push(file);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcb();\r\n\t\t\t}))\r\n\r\n\t\t\t.pipe(concat('bundle.js'))\r\n\t\t\t.pipe(sourceMap.write('.'))\r\n\t\t\t// .pipe(mode === 'production' ?\r\n\t\t\t// \tuglify() :\r\n\t\t\t// \tthrough.obj((chunk, enc, cb) =>\r\n\t\t\t// \t\tcb(null, chunk))\r\n\t\t\t// )\r\n\r\n\t\t\t//Save\r\n\t\t\t.pipe(gulp.dest(`${DIST_PATH}/js`))\r\n\t\t\t//Reload\r\n\t\t\t.pipe(browserSync.stream());\r\n\t};\r\n}\r\n\r\nfunction image() {\r\n\treturn gulp.src(`${SRC_PATH}/image/**/*.*`)\r\n\t\t//Minify\r\n\t\t.pipe(imagemin())\r\n\t\t.pipe(gulp.dest(`${DIST_PATH}/image/`))\r\n\t\t.pipe(browserSync.stream());\r\n}\r\n\r\nfunction pug() {\r\n\treturn gulp.src(`${SRC_PATH}/pug/**/*.page.pug`, {\r\n\t\tallowEmpty: true\r\n\t})\r\n\t\t.pipe(pugCompiler({pretty: true}))\r\n\t\t.pipe(rename((path) => ({\r\n\t\t\tbasename: path.basename.slice(0, path.basename.lastIndexOf('.')),\r\n\t\t\tdirname: path.dirname.split('\\\\').slice(0, -1).join('\\\\'),\r\n\t\t\textname: '.html'\r\n\t\t})))\r\n\t\t.pipe(gulp.dest(`${DIST_PATH}`))\r\n\t\t.pipe(browserSync.stream());\r\n}\r\n\r\nfunction watch(){\r\n\tbrowserSync.init({\r\n\t\tproxy: '127.0.0.1:8000'\r\n\t});\r\n\r\n\tgulp.watch(`${SRC_PATH}/pug/**/*.page.pug`, pug).on('change', browserSync.reload);\r\n\tgulp.watch(`${SRC_PATH}/scss/**/*.scss`, scss);\r\n\tgulp.watch(`${SRC_PATH}/js/**/*.tsx`, js('development'));\r\n\tgulp.watch(`${SRC_PATH}/js/**/*.ts`, js('development'));\r\n}\r\n\r\nfunction build(){\r\n\treturn gulp.parallel(\r\n\t\tpug, scss, js('production'), image\r\n\t);\r\n}\r\n\r\ngulp.task('scss', scss);\r\ngulp.task('html', pug);\r\ngulp.task('js', js('production'));\r\ngulp.task('image', image);\r\ngulp.task('watch', watch);\r\ngulp.task('build', build());\r\ngulp.task('default', build());\r\n"]}