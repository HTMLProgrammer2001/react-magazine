{"version":3,"file":"export.js","sourceRoot":"","sources":["../../../../../vendor/scrivo/highlight.php/tools/export.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AAEb,OAAO,CAAC,CAAC,cAAc,EAAE,gBAAgB,EAAE,mBAAmB,CAAC,EAAE,UAAS,EAAE,EAAE,GAAG,EAAE,MAAM;IACrF,IAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC;IAC/E,IAAM,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC;IACjD,IAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;IAC5B,IAAM,YAAY,GAAG,CAAC,YAAY,CAAC,CAAC;IAEpC,IAAM,SAAS,GAAG,WAAW,CAAI,GAAG,yBAAsB,CAAC,CAAC;IAC5D,IAAM,IAAI,GAAG,WAAW,CAAI,aAAa,kBAAe,CAAC,CAAC;IAQ1D,SAAS,UAAU,CAAC,IAAI,EAAE,YAAgB;QAAhB,6BAAA,EAAA,gBAAgB;QAEtC,IAAI,YAAY,GAAG,EAAE,EAAE;YACnB,OAAO;SACV;QAED,KAAK,IAAM,GAAG,IAAI,IAAI,EAAE;YACpB,IAAI,IAAI,CAAC,GAAG,CAAC,YAAY,MAAM,EAAE;gBAC7B,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC;aAChC;iBAAM,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;gBACtC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,YAAY,GAAG,CAAC,CAAC,CAAC;aAC3C;SACJ;IACL,CAAC;IAWD,SAAS,qBAAqB,CAAC,CAAC;QAC5B,OAAO,CAAC,CAAC,OAAO,CAAC,oBAAoB,EAAE,SAAS,CAAC,CAAC;IACtD,CAAC;IAOD,SAAS,UAAU,CAAC,IAAI;QACpB,IAAM,CAAC,GAAG,WAAW,CAAI,aAAa,mBAAc,IAAI,QAAK,CAAC,CAAC;QAC/D,IAAM,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;QAE7B,UAAU,CAAC,CAAC,CAAC,CAAC;QACd,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAE/B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAClB,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjE,CAAC;IAED,EAAE,CAAC,OAAO,CAAI,aAAa,gBAAa,EAAC,UAAS,GAAG,EAAE,KAAK;QACxD,IAAI,GAAG,EAAE;YACL,MAAM,GAAG,CAAC;SACb;QAGD,KAAK,CAAC,OAAO,CAAC,UAAS,IAAI;YACvB,IAAI,IAAI,KAAK,WAAW,IAAI,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;gBACzD,OAAO;aACV;YAED,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;QAIH,YAAY,CAAC,OAAO,CAAC,UAAS,IAAI;YAC9B,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","sourcesContent":["\"use strict\";\n\nrequire([\"dojo/node!fs\", \"dojox/json/ref\", \"dojo/_base/kernel\"], function(fs, ref, kernel) {\n    const nodeRequire = kernel.global.require && kernel.global.require.nodeRequire;\n    const HIGHLIGHT_DIR = dojo.config.highlightJsDir;\n    const CWD = dojo.config.cwd;\n    const LANGS_W_DEPS = ['arduino.js'];\n\n    const cloneDeep = nodeRequire(`${CWD}/lodash.cloneDeep.js`);\n    const hljs = nodeRequire(`${HIGHLIGHT_DIR}/highlight.js`);\n\n    /**\n     * Translate any RegExp objects that may exist in a language definition into a string representation.\n     *\n     * @param {Object} lang\n     * @param {number} nestingLevel\n     */\n    function regexToStr(lang, nestingLevel = 0) {\n        // Max recursion level\n        if (nestingLevel > 15) {\n            return;\n        }\n\n        for (const key in lang) {\n            if (lang[key] instanceof RegExp) {\n                lang[key] = lang[key].source;\n            } else if (typeof lang[key] === 'object') {\n                regexToStr(lang[key], nestingLevel + 1);\n            }\n        }\n    }\n\n    /**\n     * PCRE does not support the `\\uXXXX` syntax, so we must use `\\x{XXXX}` instead.\n     *\n     * @param {string} s\n     *\n     * @see https://www.regular-expressions.info/unicode.html#codepoint\n     *\n     * @returns {string}\n     */\n    function jsUnicodeToPhpUnicode(s) {\n        return s.replace(/\\\\u([0-9A-Fa-f]+)/g, \"\\\\x{$1}\");\n    }\n\n    /**\n     * Load a language and export it as a translated string to STDOUT.\n     *\n     * @param {string} lang\n     */\n    function exportLang(lang) {\n        const x = nodeRequire(`${HIGHLIGHT_DIR}/languages/${lang}.js`);\n        const l = cloneDeep(x(hljs));\n\n        regexToStr(l);\n        hljs.registerLanguage(lang, x);\n\n        console.log(lang);\n        console.log(jsUnicodeToPhpUnicode(dojox.json.ref.toJson(l)));\n    }\n\n    fs.readdir(`${HIGHLIGHT_DIR}/languages/`,function(err, files) {\n        if (err) {\n            throw err;\n        }\n\n        // Load all of the languages that don't extend other languages\n        files.forEach(function(file) {\n            if (file === \".DS_Store\" || LANGS_W_DEPS.indexOf(file) >= 0) {\n                return;\n            }\n\n            exportLang(file.replace(/\\.js$/, \"\"));\n        });\n\n        // These languages extend other languages, so we need to make sure that\n        // they are loaded *after* all the standard languages are loaded.\n        LANGS_W_DEPS.forEach(function(file) {\n            exportLang(file.replace(/\\.js$/, \"\"));\n        });\n    });\n});\n"]}