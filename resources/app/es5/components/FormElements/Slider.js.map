{"version":3,"sources":["components/FormElements/Slider.tsx"],"names":[],"mappings":"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","file":"Slider.js","sourcesContent":["import * as React from 'react';\r\nimport {WrappedFieldProps, change} from 'redux-form';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\n\r\n\r\nconst connected = connect();\r\n\r\ntype ISliderProps = {\r\n\tmin: number,\r\n\tmax: number,\r\n\tformName: string\r\n}\r\n\r\ntype IWhich = 'left' | 'right' | null;\r\n\r\ntype ISliderState = {\r\n\twhich: IWhich,\r\n\tleft: number,\r\n\tright: number\r\n}\r\n\r\ntype IElementProps = WrappedFieldProps &\r\n\tReact.InputHTMLAttributes<HTMLDivElement> &\r\n\tISliderProps & ConnectedProps<typeof connected>;\r\n\r\nclass SliderElement extends React.Component<IElementProps, ISliderState>{\r\n\tparent: React.RefObject<HTMLDivElement>;\r\n\tindicator: React.RefObject<HTMLDivElement>;\r\n\tleft: React.RefObject<HTMLDivElement>;\r\n\tright: React.RefObject<HTMLDivElement>;\r\n\r\n\tconstructor(props: IElementProps){\r\n\t\tsuper(props);\r\n\r\n\t\t//Refs\r\n\t\tthis.parent = React.createRef<HTMLDivElement>();\r\n\t\tthis.indicator = React.createRef<HTMLDivElement>();\r\n\t\tthis.left = React.createRef<HTMLDivElement>();\r\n\t\tthis.right = React.createRef<HTMLDivElement>();\r\n\t\t\r\n\t\t//Set state\r\n\t\tthis.state = {\r\n\t\t\twhich: null,\r\n\t\t\tleft: 0,\r\n\t\t\tright: 0\r\n\t\t};\r\n\r\n\t\t//Bind events\r\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\r\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {\r\n\t\t// 50..100 60 => (60 - 50)/(100 - 50)\r\n\r\n\t\tconst {min, max, input: {value}} = this.props;\r\n\r\n\t\t//Calculate positions\r\n\t\tconst leftPosition = (value.from - min)/(max - min) * 100;\r\n\t\tconst rightPosition = (value.to - min)/(max - min) * 100;\r\n\r\n\t\tthis.setState({\r\n\t\t\tleft: leftPosition,\r\n\t\t\tright: rightPosition\r\n\t\t});\r\n\r\n\t\t//Add document mouse move listener\r\n\t\tdocument.addEventListener('mousemove', this.onMouseMove);\r\n\t\tdocument.addEventListener('mouseup', this.onMouseUp);\r\n\t}\r\n\r\n\tcomponentDidUpdate(): void {\r\n\t\tthis.positeSlider();\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t\t<div \r\n\t\t\t\tclassName={`goods__price ${this.props.className}`} \r\n\t\t\t\tref={this.parent}\r\n\t\t\t>\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"goods__price-point left\" \r\n\t\t\t\t\tref={this.left}\r\n\t\t\t\t\tonMouseDown={this.onMouseDown.bind(this, 'left')}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"goods__price-indicator\" ref={this.indicator}/>\r\n\t\t\t\t\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"goods__price-point right\" \r\n\t\t\t\t\tref={this.right}\r\n\t\t\t\t\tonMouseDown={this.onMouseDown.bind(this, 'right')}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentWillUnmount(): void {\r\n\t\tdocument.removeEventListener('mousemove', this.onMouseMove);\r\n\t\tdocument.removeEventListener('mouseup', this.onMouseUp);\r\n\t}\r\n\r\n\tonMouseDown(which: IWhich = 'left'){\r\n\t\tthis.setState({\r\n\t\t\twhich\r\n\t\t});\r\n\r\n\t\tconsole.log(which);\r\n\t}\r\n\t\r\n\tonMouseMove(event: any){\r\n\t\tif(!this.state.which) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {min, max, dispatch} = this.props;\r\n\r\n\t\tconst parentBox = this.parent.current!.getBoundingClientRect();\r\n\t\tconst newPos = (event.clientX - parentBox.left)/parentBox.width * 100;\r\n\r\n\t\t//Move left point\r\n\t\tif(this.state.which == 'left' && newPos < this.state.right - 5) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tleft: newPos < 0 ? 0 : newPos\r\n\t\t\t});\r\n\t\t}\r\n\t\t//Move right point\r\n\t\telse if(this.state.which == 'right' && newPos > this.state.left + 5){\r\n\t\t\tthis.setState({\r\n\t\t\t\tright: 100 - (newPos > 100 ? 100 : newPos)\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t//Dispatch change\r\n\t\tdispatch(change(this.props.formName, 'priceRange', {\r\n\t\t\tfrom: this.state.left/100 * (max - min) + min,\r\n\t\t\tto: (100 - this.state.right)/100 * (max - min) + min\r\n\t\t}));\r\n\t}\r\n\t\r\n\tonMouseUp(){\r\n\t\tthis.setState({\r\n\t\t\twhich: null\r\n\t\t});\r\n\t}\r\n\r\n\tpositeSlider(){\r\n\t\t//Set positions to manipulators and line\r\n\t\tthis.left.current!.style.left = `${this.state.left}%`;\r\n\t\tthis.right.current!.style.right = `${this.state.right}%`;\r\n\t\t\r\n\t\tthis.indicator.current!.style.left = `${this.state.left}%`;\r\n\t\tthis.indicator.current!.style.right = `${this.state.right}%`;\r\n\t}\r\n}\r\n\r\nexport default connected(SliderElement);\r\n"]}