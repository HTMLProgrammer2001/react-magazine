{"version":3,"sources":["components/FormElements/Slider.tsx"],"names":[],"mappings":"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","file":"Slider.js","sourcesContent":["import * as React from 'react';\r\nimport {WrappedFieldProps, change} from 'redux-form';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\nimport {Dispatch} from 'redux';\r\n\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: ISliderProps) => ({\r\n\tchangeValue: (name: string, newValue: any) => {\r\n\t\tdispatch(change(ownProps.formName, name, newValue));\r\n\t}\r\n});\r\n\r\nconst connected = connect(null, mapDispatchToProps);\r\n\r\ntype ISliderProps = {\r\n\tmin: number,\r\n\tmax: number,\r\n\tformName: string\r\n}\r\n\r\ntype IWhich = 'left' | 'right' | null;\r\n\r\ntype ISliderState = {\r\n\twhich: IWhich\r\n}\r\n\r\ntype IElementProps = WrappedFieldProps &\r\n\tReact.InputHTMLAttributes<HTMLDivElement> &\r\n\tISliderProps & ConnectedProps<typeof connected>;\r\n\r\nclass SliderElement extends React.Component<IElementProps, ISliderState>{\r\n\tparent: React.RefObject<HTMLDivElement>;\r\n\tindicator: React.RefObject<HTMLDivElement>;\r\n\tleft: React.RefObject<HTMLDivElement>;\r\n\tright: React.RefObject<HTMLDivElement>;\r\n\r\n\tleftPosition: number;\r\n\trightPosition: number;\r\n\r\n\tconstructor(props: IElementProps){\r\n\t\tsuper(props);\r\n\r\n\t\t//Refs\r\n\t\tthis.parent = React.createRef<HTMLDivElement>();\r\n\t\tthis.indicator = React.createRef<HTMLDivElement>();\r\n\t\tthis.left = React.createRef<HTMLDivElement>();\r\n\t\tthis.right = React.createRef<HTMLDivElement>();\r\n\t\tthis.leftPosition = 0;\r\n\t\tthis.rightPosition = 0;\r\n\t\t\r\n\t\t//Set state\r\n\t\tthis.state = {\r\n\t\t\twhich: null\r\n\t\t};\r\n\r\n\t\t//Bind events\r\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\r\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {\r\n\t\t// 50..100 60 => (60 - 50)/(100 - 50)\r\n\r\n\t\tconst {min, max, input: {value}} = this.props;\r\n\r\n\t\t//Calculate positions\r\n\t\tthis.leftPosition = (value.from - min)/(max - min) * 100;\r\n\t\tthis.rightPosition = 100 - (value.to - min)/(max - min) * 100;\r\n\r\n\t\tthis.positeSlider();\r\n\r\n\t\t//Add document mouse move listener\r\n\t\tdocument.addEventListener('mousemove', this.onMouseMove);\r\n\t\tdocument.addEventListener('mouseup', this.onMouseUp);\r\n\t}\r\n\r\n\tcomponentDidUpdate(): void {\r\n\t\tconst {min, max, input: {value}} = this.props;\r\n\r\n\t\t//Calculate positions\r\n\t\tthis.leftPosition = (value.from - min)/(max - min) * 100;\r\n\t\tthis.rightPosition = 100 - (value.to - min)/(max - min) * 100;\r\n\r\n\t\tthis.positeSlider();\r\n\t}\r\n\r\n\trender(){\r\n\t\treturn (\r\n\t\t\t<div \r\n\t\t\t\tclassName={`goods__price ${this.props.className}`} \r\n\t\t\t\tref={this.parent}\r\n\t\t\t>\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"goods__price-point left\" \r\n\t\t\t\t\tref={this.left}\r\n\t\t\t\t\tonMouseDown={this.onMouseDown.bind(this, 'left')}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"goods__price-indicator\" ref={this.indicator}/>\r\n\t\t\t\t\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"goods__price-point right\" \r\n\t\t\t\t\tref={this.right}\r\n\t\t\t\t\tonMouseDown={this.onMouseDown.bind(this, 'right')}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentWillUnmount(): void {\r\n\t\tdocument.removeEventListener('mousemove', this.onMouseMove);\r\n\t\tdocument.removeEventListener('mouseup', this.onMouseUp);\r\n\t}\r\n\r\n\tonMouseDown(which: IWhich = 'left'){\r\n\t\tthis.setState({\r\n\t\t\twhich\r\n\t\t});\r\n\t}\r\n\t\r\n\tonMouseMove(event: any){\r\n\t\tif(!this.state.which) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {min, max, input: {value}} = this.props;\r\n\r\n\t\tconst parentBox = this.parent.current!.getBoundingClientRect();\r\n\t\tlet newPos = (event.clientX - parentBox.left)/parentBox.width * 100;\r\n\r\n\t\tconsole.log(this.props.input.name);\r\n\r\n\t\t//Change value\r\n\t\tif(this.state.which == 'left' && newPos < 95 - this.rightPosition){\r\n\t\t\tnewPos = newPos < 0 ? 0 : newPos;\r\n\r\n\t\t\tthis.props.changeValue(this.props.input.name || 'priceRange', {\r\n\t\t\t\tfrom: newPos/100 * (max - min),\r\n\t\t\t\tto: value.to\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if(this.state.which == 'right' && newPos > this.leftPosition + 5){\r\n\t\t\tnewPos = newPos > 100 ? 100 : newPos;\r\n\r\n\t\t\tthis.props.changeValue(this.props.name || 'priceRange', {\r\n\t\t\t\tfrom: value.from,\r\n\t\t\t\tto: newPos/100 * (max - min)\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tonMouseUp(){\r\n\t\tthis.setState({\r\n\t\t\twhich: null\r\n\t\t});\r\n\t}\r\n\r\n\tpositeSlider(){\r\n\t\t//Set positions to manipulators and line\r\n\t\tthis.left.current!.style.left = `${this.leftPosition}%`;\r\n\t\tthis.right.current!.style.right = `${this.rightPosition}%`;\r\n\t\t\r\n\t\tthis.indicator.current!.style.left = `${this.leftPosition}%`;\r\n\t\tthis.indicator.current!.style.right = `${this.rightPosition}%`;\r\n\t}\r\n}\r\n\r\nexport default connected(SliderElement);\r\n\r\n"]}